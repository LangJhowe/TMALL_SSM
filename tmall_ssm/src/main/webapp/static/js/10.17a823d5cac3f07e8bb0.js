webpackJsonp([10],{"9lya":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("vMJZ"),s=a("xO/y"),r=a("ZoQJ"),n={data:function(){return{orderData:{},review:"",reviewList:[],pager:{total:1,page:1}}},computed:{oid:function(){return this.$route.query.oid},onlyReview:function(){return!!this.$route.query.onlyReview&&this.$route.query.onlyReview},pid:function(){return this.$route.query.pid}},mounted:function(){this.getPayedOrder(),this.getReviews()},methods:{submitReview:function(){var t=this;Object(i.m)({oid:this.oid,review:this.review}).then(function(e){var a=e.data;if(t.$CODES.SUCCESS==a.code){t.reviewList=a.data;var i=a.pid;t.$router.push({path:"/buyStep/stepReview",query:{oid:t.oid,pid:i,onlyReview:!0}})}})},getReviews:function(){var t=this;this.pid&&this.onlyReview&&Object(s.e)({pid:this.pid,page:this.pager.page}).then(function(e){var a=e.data;t.$CODES.SUCCESS==a.code&&(t.pager.total=a.total,t.reviewList=a.data.map(function(t){return{createDate:t.createDate,content:t.content,username:t.user.name}}))})},getPayedOrder:function(){var t=this;Object(i.l)({oid:this.oid}).then(function(e){var a=e.data;t.$CODES.SUCCESS==a.code&&(t.orderData=a.data)})},pagerChange:function(t){this.pager.page=t,this.getReviews()},formatPrice:function(t){return t?Object(r.d)(t,2):"0.00"},formatDateCN:function(t){return Object(r.c)(t)},formatDAT:function(t){return Object(r.a)(t)}},watch:{$route:function(){this.$route.query.hasOwnProperty("onlyReview")&&this.$route.query.onlyReview&&(this.getReviews(),this.getPayedOrder())}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step-review"},[a("div",{staticClass:"m_container"},[t.orderData.id?a("div",{staticClass:"review-box"},[a("div",{staticClass:"product-info"},[a("div",{staticClass:"p-img"},[a("img",{attrs:{src:"/img/productSingle/"+t.orderData.orderItems[0].product.firstProductImage.id+".jpg",alt:""}})]),t._v(" "),a("div",{staticClass:"p-main"},[a("p",{staticClass:"name"},[t._v(t._s(t.orderData.orderItems[0].product.name))]),t._v(" "),a("p",{staticClass:"price"},[a("span",{staticClass:"item"},[t._v("价格：")]),t._v(" "),a("strong",[t._v("￥"+t._s(t.formatPrice(t.orderData.orderItems[0].product.promotePrice)))]),t._v("元\n          ")]),t._v(" "),t._m(0),t._v(" "),a("p",{staticClass:"sales"},[a("span",{staticClass:"item"},[t._v("月销量：")]),t._v(" "),a("strong",[t._v(t._s(t.orderData.orderItems[0].product.saleCount))]),t._v("件\n          ")]),t._v(" "),a("div",{staticClass:"buy-msg"},[t._m(1),t._v(" "),a("ul",[a("li",[t._v("于"+t._s(t.formatDateCN(t.orderData.createDate))+"下单购买了此商品")]),t._v(" "),a("li",[t._v("一共购买了"+t._s(t.orderData.totalNumber)+"件")]),t._v(" "),a("li",[t._v("商品描述——"+t._s(t.orderData.orderItems[0].product.subTitle))])])])])]),t._v(" "),t.onlyReview?a("div",{staticClass:"all-reviews"},[a("div",{staticClass:"brow"},[a("div",{staticClass:"top"}),t._v(" "),a("p",[t._v("累计评价 "),a("span",[t._v(t._s(t.orderData.orderItems[0].product.reviewCount)+"条")])]),t._v(" "),a("div",{staticClass:"line"})]),t._v(" "),a("ul",{staticClass:"review-list"},t._l(t.reviewList,function(e){return a("li",{key:e.id},[a("p",[a("span",{staticClass:"review-time"},[t._v(t._s(t.formatDAT(e.createDate)))]),t._v(" "),a("span",{staticClass:"review-content"},[t._v(t._s(e.content))]),t._v(" "),a("span",{staticClass:"review-user"},[t._v(t._s(e.username)+" "),a("span",{staticClass:"anonymous"},[t._v("(匿名)")])])])])}),0),t._v(" "),a("div",{staticClass:"pager"},[a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.pager.total,"current-page":t.pager.page},on:{"current-change":t.pagerChange}})],1)]):a("div",{staticClass:"review-board"},[a("div",{staticClass:"main"},[a("div",{staticClass:"inner"},[a("p",[t._v("其他买家,需要哦你的建议哦！")]),t._v(" "),a("div",{staticClass:"text"},[a("label",{staticClass:"name",attrs:{for:"review"}},[t._v("评价商品")]),t._v(" "),a("div",{staticClass:"value"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.review,expression:"review"}],attrs:{name:"review",id:"review",cols:"30",rows:"10"},domProps:{value:t.review},on:{input:function(e){e.target.composing||(t.review=e.target.value)}}})])])]),t._v(" "),a("div",{staticClass:"submit-review"},[a("button",{on:{click:function(e){return t.submitReview()}}},[t._v("提交评价")])])])])]):t._e()])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"delivery"},[e("span",{staticClass:"item"},[this._v("配送：")]),this._v(" "),e("span",[this._v("快递:0.00")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("i",{staticClass:"reviewProductInfoRightBelowImg"}),e("span",[this._v("现在查看的是 您所购买商品的信息")])])}]},v=a("C7Lr")(n,o,!1,function(t){a("9qW2")},null,null);e.default=v.exports},"9qW2":function(t,e){}});